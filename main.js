!function(){"use strict";function e(e,t){const a=e+1;let s="";return a<=t&&(s+="top-"),a>t**2-t&&(s+="bottom-"),Number.isInteger((a-1)/t)?s+="left":Number.isInteger(a/t)?s+="right":s=s.slice(0,-1),""!==s?s:"center"}function t(e,t,a){const s=Array(a**2);s.fill(0);const i=s.map(((e,t)=>({x:t%a,y:Math.floor(t/a)}))),r=i[e],l=i[t];return{diffX:Math.abs(r.x-l.x),diffY:Math.abs(r.y-l.y)}}function a(e,a,s,i=8){const r=t(e,a,i);return r.diffX<=s&&r.diffY<=s&&(0===r.diffY||0===r.diffX||r.diffX===r.diffY)}function s(e,a,s,i=8){const r=t(e,a,i);return r.diffX<=s&&r.diffY<=s}var i="prairie";class r{constructor(e,t="generic"){if("Character"===new.target.name)throw new Error("You can't create Character class directly");this.level=e,this.attack=0,this.defence=0,this.health=50,this.type=t}damage(e){this.health>0?this.health<=e?this.health=0:this.health-=e:this.health=0}}class l{constructor(e,t){if(!(e instanceof r))throw new Error("character must be instance of Character or its children");if("number"!=typeof t)throw new Error("position must be a number");this.character=e,this.position=t}}function c(e,t=8){const a=[...Array(t**2).keys()];let s;return s="opponent"===e?a.filter((e=>e%t==6||e%t==7)):a.filter((e=>e%t==0||e%t==1)),s}function*n(e,t){for(;;){const a=Math.floor(e.length*Math.random()),s=Math.floor(Math.random()*t)+1;yield new e[a](s)}}function h(e,t,a){const s=[],i=c("player",8),r=c("opponent",8);for(let c=0;c<a;c+=1){const a=n(e,t).next().value;let c,h;a.isGoodCharacter?(c=Math.floor(i.length*Math.random()),h=i[c],i.splice(c,1)):(c=Math.floor(r.length*Math.random()),h=r[c],r.splice(c,1)),s.push(new l(a,h))}return s}class o extends r{constructor(e){super(e,"bowman"),this.attack=25,this.defence=25,this.moveCell=2,this.attackCell=2,this.isGoodCharacter=!0}}class d extends r{constructor(e){super(e,"daemon"),this.attack=10,this.defence=40,this.moveCell=1,this.attackCell=4,this.isGoodCharacter=!1}}class m extends r{constructor(e){super(e,"magician"),this.attack=10,this.defence=40,this.moveCell=1,this.attackCell=4,this.isGoodCharacter=!0}}class C extends r{constructor(e){super(e,"swordsman"),this.attack=40,this.defence=10,this.moveCell=4,this.attackCell=1,this.isGoodCharacter=!0}}class p extends r{constructor(e){super(e,"undead"),this.attack=40,this.defence=10,this.moveCell=4,this.attackCell=1,this.isGoodCharacter=!1}}class f extends r{constructor(e){super(e,"vampire"),this.attack=25,this.defence=25,this.moveCell=2,this.attackCell=2,this.isGoodCharacter=!1}}class u{constructor(){this.playerTeam=[o,C,m],this.opponentTeam=[d,p,f]}}class g{constructor(e,t){this.playerTeam=e,this.opponentTeam=t,this.playerMove=!0}static from(e){return null}}var v="pointer",y="crosshair",L="not-allowed";const E=new class{constructor(){this.boardSize=8,this.container=null,this.boardEl=null,this.cells=[],this.cellClickListeners=[],this.cellEnterListeners=[],this.cellLeaveListeners=[],this.newGameListeners=[],this.saveGameListeners=[],this.loadGameListeners=[]}bindToDOM(e){if(!(e instanceof HTMLElement))throw new Error("container is not HTMLElement");this.container=e}drawUi(t){this.checkBinding(),this.container.innerHTML='\n      <div class="controls">\n        <button data-id="action-restart" class="btn">New Game</button>\n        <button data-id="action-save" class="btn">Save Game</button>\n        <button data-id="action-load" class="btn">Load Game</button>\n      </div>\n      <div class="board-container">\n        <div data-id="board" class="board"></div>\n      </div>\n    ',this.newGameEl=this.container.querySelector("[data-id=action-restart]"),this.saveGameEl=this.container.querySelector("[data-id=action-save]"),this.loadGameEl=this.container.querySelector("[data-id=action-load]"),this.newGameEl.addEventListener("click",(e=>this.onNewGameClick(e))),this.saveGameEl.addEventListener("click",(e=>this.onSaveGameClick(e))),this.loadGameEl.addEventListener("click",(e=>this.onLoadGameClick(e))),this.boardEl=this.container.querySelector("[data-id=board]"),this.boardEl.classList.add(t);for(let t=0;t<this.boardSize**2;t+=1){const a=document.createElement("div");a.classList.add("cell","map-tile",`map-tile-${e(t,this.boardSize)}`),a.addEventListener("mouseenter",(e=>this.onCellEnter(e))),a.addEventListener("mouseleave",(e=>this.onCellLeave(e))),a.addEventListener("click",(e=>this.onCellClick(e))),this.boardEl.appendChild(a)}this.cells=Array.from(this.boardEl.children)}redrawPositions(e){for(const e of this.cells)e.innerHTML="";for(const a of e){const e=this.boardEl.children[a.position],s=document.createElement("div");s.classList.add("character",a.character.type);const i=document.createElement("div");i.classList.add("health-level");const r=document.createElement("div");r.classList.add("health-level-indicator","health-level-indicator-"+((t=a.character.health)<15?"critical":t<50?"normal":"high")),r.style.width=`${a.character.health}%`,i.appendChild(r),s.appendChild(i),e.appendChild(s)}var t}addCellEnterListener(e){this.cellEnterListeners.push(e)}addCellLeaveListener(e){this.cellLeaveListeners.push(e)}addCellClickListener(e){this.cellClickListeners.push(e)}addNewGameListener(e){this.newGameListeners.push(e)}addSaveGameListener(e){this.saveGameListeners.push(e)}addLoadGameListener(e){this.loadGameListeners.push(e)}onCellEnter(e){e.preventDefault();const t=this.cells.indexOf(e.currentTarget);this.cellEnterListeners.forEach((e=>e.call(null,t)))}onCellLeave(e){e.preventDefault();const t=this.cells.indexOf(e.currentTarget);this.cellLeaveListeners.forEach((e=>e.call(null,t)))}onCellClick(e){const t=this.cells.indexOf(e.currentTarget);this.cellClickListeners.forEach((e=>e.call(null,t)))}onNewGameClick(e){e.preventDefault(),this.newGameListeners.forEach((e=>e.call(null)))}onSaveGameClick(e){e.preventDefault(),this.saveGameListeners.forEach((e=>e.call(null)))}onLoadGameClick(e){e.preventDefault(),this.loadGameListeners.forEach((e=>e.call(null)))}static showError(e){alert(e)}static showMessage(e){alert(e)}selectCell(e,t="yellow"){this.deselectCell(e),this.cells[e].classList.add("selected",`selected-${t}`)}deselectCell(e){const t=this.cells[e];t.classList.remove(...Array.from(t.classList).filter((e=>e.startsWith("selected"))))}showCellTooltip(e,t){this.cells[t].title=e}hideCellTooltip(e){this.cells[e].title=""}showDamage(e,t){return new Promise((a=>{const s=this.cells[e],i=document.createElement("span");i.textContent=t,i.classList.add("damage"),s.appendChild(i),i.addEventListener("animationend",(()=>{s.removeChild(i),a()}))}))}setCursor(e){this.boardEl.style.cursor=e}checkBinding(){if(null===this.container)throw new Error("GamePlay not bind to DOM")}};E.bindToDOM(document.querySelector("#game-container"));const S=new class{constructor(e){this.storage=e}save(e){this.storage.setItem("state",JSON.stringify(e))}load(){try{return JSON.parse(this.storage.getItem("state"))}catch(e){throw new Error("Invalid state")}}}(localStorage),w=new class{constructor(e,t){this.gamePlay=e,this.stateService=t,this.playerTeam=h((new u).playerTeam,1,3),this.opponentTeam=h((new u).opponentTeam,1,3),this.gameState=new g(this.playerTeam,this.opponentTeam)}init(){this.gamePlay.drawUi(i),this.gamePlay.redrawPositions([...this.playerTeam,...this.opponentTeam]),this.enterOnCell(),this.leaveOnCell(),this.clickOnCell()}onCellClick(e){if(this.gameState.selectedCharacter&&this.gameState.selectedCharacter.position===e)this.gamePlay.deselectCell(e),this.gameState.selectedCharacter=null;else{const t=this.hasCharacter(e),i=this.getCharacter(e);if(t&&i.character.isGoodCharacter&&(this.gameState.selectedCharacter=i,this.gamePlay.cells.forEach((e=>{e.classList.remove(...Array.from(e.classList).filter((e=>e.startsWith("selected"))))})),this.gamePlay.selectCell(e),this.gamePlay.setCursor(v)),this.gameState.selectedCharacter&&!t){const t=this.gameState.selectedCharacter.character.moveCell;a(this.gameState.selectedCharacter.position,e,t)&&(this.gameState.playerTeam=this.filterTeam(this.gameState.selectedCharacter),this.gameState.playerTeam=[...this.gameState.playerTeam,this.gameState.selectedCharacter],this.gameState.selectedCharacter.position=e,this.endMove())}if(this.gameState.selectedCharacter&&t){const t=this.gameState.selectedCharacter.character.attackCell,a=this.gameState.selectedCharacter.position;s(a,e,t)&&a!==e&&this.attackCharacter(this.gameState.selectedCharacter,i)}}}onCellEnter(e){const t=this.hasCharacter(e),i=this.getCharacter(e);if(t){const t=`ðŸŽ–${i.character.level} ðŸ—¡${i.character.attack} ðŸ›¡${i.character.defence} ðŸ’“${i.character.health}`;this.gamePlay.showCellTooltip(t,e)}if(this.gameState.selectedCharacter&&!t){const t=this.gameState.selectedCharacter.character.moveCell;a(this.gameState.selectedCharacter.position,e,t)&&(this.gamePlay.selectCell(e,"green"),this.gamePlay.setCursor(v))}if(t&&this.gameState.selectedCharacter&&!i.character.isGoodCharacter){const t=this.gameState.selectedCharacter.character.attackCell;s(this.gameState.selectedCharacter.position,e,t)?(this.gamePlay.selectCell(e,"red"),this.gamePlay.setCursor(y)):this.gamePlay.setCursor(L)}}onCellLeave(e){this.gamePlay.setCursor(v),this.gamePlay.cells.forEach((e=>e.classList.remove("selected-green","selected-red"))),this.gamePlay.hideCellTooltip(e)}hasCharacter(e){return[...this.playerTeam,...this.opponentTeam].some((t=>t.position===e))}getCharacter(e){let t=this.playerTeam.find((t=>t.position===e));return t||(t=this.opponentTeam.find((t=>t.position===e))),t}enterOnCell(){this.gamePlay.addCellEnterListener(this.onCellEnter.bind(this))}leaveOnCell(){this.gamePlay.addCellLeaveListener(this.onCellLeave.bind(this))}clickOnCell(){this.gamePlay.addCellClickListener(this.onCellClick.bind(this))}filterTeam(e){let t;return t=e.character.isGoodCharacter?this.gameState.playerTeam.filter((t=>t.position!==e.position)):this.gameState.opponentTeam.filter((t=>t.position!==e.position)),t}endMove(){this.gamePlay.cells.forEach((e=>{e.classList.remove(...Array.from(e.classList).filter((e=>e.startsWith("selected"))))})),this.gamePlay.redrawPositions([...this.gameState.playerTeam,...this.gameState.opponentTeam]),this.gameState.playerMove?this.gameState.playerMove=!1:this.gameState.playerMove=!0}attackCharacter(e,t){if(!e||!t)return;const a=Math.floor(Math.max(e.character.attack-t.character.defence,.1*e.character.attack));t.character.isGoodCharacter?this.gameState.playerTeam=this.filterTeam(t):this.gameState.opponentTeam=this.filterTeam(t),t.character.damage(a),t.character.health>0&&(t.character.isGoodCharacter,this.gameState.playerTeam=[...this.gameState.playerTeam,t]),this.gamePlay.showDamage(t.position,a).then((()=>{this.clickOnCell()})).then((()=>{this.endMove()}))}}(E,S);w.init()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxVQUFVOUYsV0FBYSxJQUFJMUMsS0FBS3dJLFVBQVU5RixXQUFZdUgsSUFNL0RqSyxLQUFLZ0QsU0FBU29FLFdBQVc2QyxFQUFTekosU0FBVTBKLEdBQ3pDRSxNQUFLLEtBQ0pwSyxLQUFLNkksYUFBYSxJQUVuQnVCLE1BQUssS0FDSnBLLEtBQUt3SixTQUFTLEdBRXBCLEdIM0xrQ3hHLEVBQVU0RSxHQUM5Q1csRUFBU0UsTSIsInNvdXJjZXMiOlsid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL3V0aWxzLmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL3RoZW1lcy5qcyIsIndlYnBhY2s6Ly9qcy1wcm8tZGlwbG9tYS8uL3NyYy9qcy9DaGFyYWN0ZXIuanMiLCJ3ZWJwYWNrOi8vanMtcHJvLWRpcGxvbWEvLi9zcmMvanMvUG9zaXRpb25lZENoYXJhY3Rlci5qcyIsIndlYnBhY2s6Ly9qcy1wcm8tZGlwbG9tYS8uL3NyYy9qcy9nZW5lcmF0b3JzLmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL2NoYXJhY3RlcnMvQm93bWFuLmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL2NoYXJhY3RlcnMvRGFlbW9uLmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL2NoYXJhY3RlcnMvTWFnaWNpYW4uanMiLCJ3ZWJwYWNrOi8vanMtcHJvLWRpcGxvbWEvLi9zcmMvanMvY2hhcmFjdGVycy9Td29yZHNtYW4uanMiLCJ3ZWJwYWNrOi8vanMtcHJvLWRpcGxvbWEvLi9zcmMvanMvY2hhcmFjdGVycy9VbmRlYWQuanMiLCJ3ZWJwYWNrOi8vanMtcHJvLWRpcGxvbWEvLi9zcmMvanMvY2hhcmFjdGVycy9WYW1waXJlLmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL1RlYW0uanMiLCJ3ZWJwYWNrOi8vanMtcHJvLWRpcGxvbWEvLi9zcmMvanMvR2FtZVN0YXRlLmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL2N1cnNvcnMuanMiLCJ3ZWJwYWNrOi8vanMtcHJvLWRpcGxvbWEvLi9zcmMvanMvYXBwLmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL0dhbWVQbGF5LmpzIiwid2VicGFjazovL2pzLXByby1kaXBsb21hLy4vc3JjL2pzL0dhbWVTdGF0ZVNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vanMtcHJvLWRpcGxvbWEvLi9zcmMvanMvR2FtZUNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAdG9kb1xuICogQHBhcmFtIGluZGV4IC0g0LjQvdC00LXQutGBINC/0L7Qu9GPXG4gKiBAcGFyYW0gYm9hcmRTaXplIC0g0YDQsNC30LzQtdGAINC60LLQsNC00YDQsNGC0L3QvtCz0L4g0L/QvtC70Y8gKNCyINC00LvQuNC90YMg0LjQu9C4INGI0LjRgNC40L3RgylcbiAqIEByZXR1cm5zINGB0YLRgNC+0LrQsCAtINGC0LjQvyDRj9GH0LXQudC60Lgg0L3QsCDQv9C+0LvQtTpcbiAqXG4gKiB0b3AtbGVmdFxuICogdG9wLXJpZ2h0XG4gKiB0b3BcbiAqIGJvdHRvbS1sZWZ0XG4gKiBib3R0b20tcmlnaHRcbiAqIGJvdHRvbVxuICogcmlnaHRcbiAqIGxlZnRcbiAqIGNlbnRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqc1xuICogY2FsY1RpbGVUeXBlKDAsIDgpOyAvLyAndG9wLWxlZnQnXG4gKiBjYWxjVGlsZVR5cGUoMSwgOCk7IC8vICd0b3AnXG4gKiBjYWxjVGlsZVR5cGUoNjMsIDgpOyAvLyAnYm90dG9tLXJpZ2h0J1xuICogY2FsY1RpbGVUeXBlKDcsIDcpOyAvLyAnbGVmdCdcbiAqIGBgYFxuICogKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVGlsZVR5cGUoaW5kZXgsIGJvYXJkU2l6ZSkge1xuICAvLyBUT0RPOiDQstCw0Ygg0LrQvtC0INCx0YPQtNC10YIg0YLRg9GCXG4gIGNvbnN0IGJvYXJkRnVsbFNpemUgPSBib2FyZFNpemUgKiogMjtcbiAgY29uc3Qgbm9ybUluZGV4ID0gaW5kZXggKyAxO1xuICBsZXQgcmVzdWx0ID0gJyc7XG4gIC8vINC10YHQu9C4INC90L7QvNC10YDQsCDQstC10YDRhdC90LjQtSwg0YLQviB0b3BcbiAgaWYgKG5vcm1JbmRleCA8PSBib2FyZFNpemUpIHtcbiAgICByZXN1bHQgKz0gJ3RvcC0nO1xuICB9XG4gIC8vINC10YHQu9C4INC90L7QvNC10YDQsCDQvdC40LbQvdC40LUsINGC0L4gYm90dG9tXG4gIGlmIChub3JtSW5kZXggPiBib2FyZEZ1bGxTaXplIC0gYm9hcmRTaXplKSB7XG4gICAgcmVzdWx0ICs9ICdib3R0b20tJztcbiAgfVxuICAvLyDQtdGB0LvQuCDQvdC+0LzQtdGA0LAg0LvQtdCy0YvQtSDQsiDRgdGC0L7Qu9Cx0YbQtSwg0YLQviBsZWZ0XG4gIC8vINC10YHQu9C4INC90L7QvNC10YDQsCDQv9GA0LDQstGL0LUg0LIg0YHRgtC+0LvQsdGG0LUsINGC0L4gcmlnaHRcbiAgLy8g0LIg0L/RgNC+0YLQuNCy0L3QvtC8INGB0LvRg9GH0LDQtSDRg9C00LDQu9GP0LXQvCDQtNC10YTQuNGBINC40Lcg0L/QtdGA0LXQvNC10L3QvdC+0LlcbiAgaWYgKE51bWJlci5pc0ludGVnZXIoKG5vcm1JbmRleCAtIDEpIC8gYm9hcmRTaXplKSkge1xuICAgIHJlc3VsdCArPSAnbGVmdCc7XG4gIH0gZWxzZSBpZiAoTnVtYmVyLmlzSW50ZWdlcihub3JtSW5kZXggLyBib2FyZFNpemUpKSB7XG4gICAgcmVzdWx0ICs9ICdyaWdodCc7XG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsIC0xKTtcbiAgfVxuXG4gIGlmIChyZXN1bHQgIT09ICcnKSB7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHJldHVybiAnY2VudGVyJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNIZWFsdGhMZXZlbChoZWFsdGgpIHtcbiAgaWYgKGhlYWx0aCA8IDE1KSB7XG4gICAgcmV0dXJuICdjcml0aWNhbCc7XG4gIH1cblxuICBpZiAoaGVhbHRoIDwgNTApIHtcbiAgICByZXR1cm4gJ25vcm1hbCc7XG4gIH1cblxuICByZXR1cm4gJ2hpZ2gnO1xufVxuXG4vKipcbiAqINCk0YPQvdC60YbQuNGPINCy0YvRh9C40YHQu9C10L3QuNGPINGA0LDRgdGB0YLQvtGP0L3QuNGPINC80LXQttC00YMg0LTQstGD0LzRjyDQv9C+0LfQuNGG0LjRj9C80Lgg0L/QviDQs9C+0YDQuNC30L7QvdGC0LDQu9C4IChYKSDQuCDQv9C+INCy0LXRgNGC0LjQutCw0LvQuCAoWSlcbiAqIEBmaXJzdFBvc2l0aW9uIC0g0LjQvdC00LXQutGBINC/0L7Qu9GPINCy0YvQtNC10LvQtdC90L3QvtCz0L4g0LjQs9GA0L7QutCwXG4gKiBAc2Vjb25kUG9zaXRpb24gLSDQuNC90LTQtdC60YEg0L/QvtC70Y8sINC60L7RgtC+0YDQvtC1INCy0YvQtNC10LvQuNC7INC40LPRgNC+0LpcbiAqL1xuZnVuY3Rpb24gZGlzdGFuY2VYWShmaXJzdFBvc2l0aW9uLCBzZWNvbmRQb3NpdGlvbiwgYm9hcmRTaXplKSB7XG4gIGNvbnN0IGluaXRpYWxDb29yZHMgPSBBcnJheShib2FyZFNpemUgKiogMik7XG4gIGluaXRpYWxDb29yZHMuZmlsbCgwKTtcbiAgY29uc3QgY29vcmRzID0gaW5pdGlhbENvb3Jkcy5tYXAoKGUsIGkpID0+ICh7IHg6IGkgJSBib2FyZFNpemUsIHk6IE1hdGguZmxvb3IoaSAvIGJvYXJkU2l6ZSkgfSkpO1xuICBjb25zdCBjdXJyZW50Q29vcmRzID0gY29vcmRzW2ZpcnN0UG9zaXRpb25dO1xuICBjb25zdCBuZXh0Q29vcmRzID0gY29vcmRzW3NlY29uZFBvc2l0aW9uXTtcbiAgY29uc3QgZGlmZlggPSBNYXRoLmFicyhjdXJyZW50Q29vcmRzLnggLSBuZXh0Q29vcmRzLngpO1xuICBjb25zdCBkaWZmWSA9IE1hdGguYWJzKGN1cnJlbnRDb29yZHMueSAtIG5leHRDb29yZHMueSk7XG4gIHJldHVybiB7XG4gICAgZGlmZlgsXG4gICAgZGlmZlksXG4gIH07XG59XG5cbi8qKlxuICog0KTRg9C90LrRhtC40Y8g0L/RgNC+0LLQtdGA0LrQuCDQstC+0LfQvNC+0LbQvdC+0YHRgtC4INC00LLQuNCz0LDRgtGM0YHRjyDQv9C10YDRgdC+0L3QsNC20YMg0LIg0YPQutCw0LfQsNC90L3Rg9GOINC60LvQtdGC0LrRgyDQvtGC0L3QvtGB0LjRgtC10LvRjNC90L4g0LXQs9C+INC/0L7Qu9C+0LbQtdC90LjRj1xuICogQGN1clBvc2l0aW9uIC0g0LjQvdC00LXQutGBINC/0L7Qu9GPINGC0LXQutGD0YnQtdC5INC/0L7Qt9C40YbQuNC4INC/0LXRgNGB0L7QvdCw0LbQsFxuICogQG5leHRQb3NpdGlvbiAtINC40L3QtNC10LrRgSDQv9C+0LvRjyDQv9C+0LfQuNGG0LjQuCwg0LrRg9C00LAg0L/Qu9Cw0L3QuNGA0YPQtdGC0YHRjyDQv9C10YDQtdC80LXRgdGC0LjRgtGMINC/0LXRgNGB0L7QvdCw0LbQsFxuICogQG1vdmVDZWxsIC0g0L3QsCDRgdC60L7Qu9GM0LrQviDQutC70LXRgtC+0Log0LzQvtC20LXRgiDQtNCy0LjQs9Cw0YLRjNGB0Y8g0L/QtdGA0YHQvtC90LDQtlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBwb3NzaWJsZU1vdmUoY3VyUG9zaXRpb24sIG5leHRQb3NpdGlvbiwgbW92ZUNlbGwsIGJvYXJkU2l6ZSA9IDgpIHtcbiAgY29uc3QgZGlmZkNvb3JkcyA9IGRpc3RhbmNlWFkoY3VyUG9zaXRpb24sIG5leHRQb3NpdGlvbiwgYm9hcmRTaXplKTtcbiAgaWYgKGRpZmZDb29yZHMuZGlmZlggPD0gbW92ZUNlbGwgJiYgZGlmZkNvb3Jkcy5kaWZmWSA8PSBtb3ZlQ2VsbCkge1xuICAgIGlmIChkaWZmQ29vcmRzLmRpZmZZID09PSAwIHx8IGRpZmZDb29yZHMuZGlmZlggPT09IDBcbiAgICAgIHx8IGRpZmZDb29yZHMuZGlmZlggPT09IGRpZmZDb29yZHMuZGlmZlkpIHtcbiAgICAgIC8vINC/0LXRgNC10LzQtdGJ0LXQvdC40LUg0L/QviDQs9C+0YDQuNC30L7QvdGC0LDQu9C4IC0gZGlmZkNvb3Jkcy5kaWZmWSA9PT0gMFxuICAgICAgLy8g0L/QtdGA0LXQvNC10YnQtdC90LjQtSDQv9C+INCy0LXRgNGC0LjQutCw0LvQuCAtIGRpZmZDb29yZHMuZGlmZlggPT09IDBcbiAgICAgIC8vINC/0LXRgNC10LzQtdGJ0LXQvdC40LUg0L/QviDQtNC40LDQs9C+0L3QsNC70Y/QvCAtIGRpZmZDb29yZHMuZGlmZlggPT09IGRpZmZDb29yZHMuZGlmZllcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICog0KTRg9C90LrRhtC40Y8g0L/RgNC+0LLQtdGA0LrQuCDQstC+0LfQvNC+0LbQvdC+0YHRgtC4INCw0YLQsNC60L7QstCw0YLRjCDQv9C10YDRgdC+0L3QsNC20LAg0LIg0YPQutCw0LfQsNC90L3QvtC5INC60LvQtdGC0LrQtSDQvtGC0L3QvtGB0LjRgtC10LvRjNC90L4g0LXQs9C+INC/0L7Qu9C+0LbQtdC90LjRj1xuICogQGN1clBvc2l0aW9uIC0g0LjQvdC00LXQutGBINC/0L7Qu9GPINGC0LXQutGD0YnQtdC5INC/0L7Qt9C40YbQuNC4INC/0LXRgNGB0L7QvdCw0LbQsFxuICogQG5leHRQb3NpdGlvbiAtINC40L3QtNC10LrRgSDQv9C+0LvRjyDQv9C+0LfQuNGG0LjQuCwg0LPQtNC1INC/0LvQsNC90LjRgNGD0LXRgtGB0Y8g0L/RgNC+0LjQt9Cy0LXRgdGC0Lgg0LDRgtCw0LrRgyDQv9C10YDRgdC+0L3QsNC20LBcbiAqIEBhdHRhY2tDZWxsIC0g0L3QsCDRgdC60L7Qu9GM0LrQviDQutC70LXRgtC+0Log0LzQvtC20LXRgiDQsNGC0LDQutC+0LLQsNGC0Ywg0L/QtdGA0YHQvtC90LDQtlxuICovXG5leHBvcnQgZnVuY3Rpb24gcG9zc2libGVBdHRhY2soY3VyUG9zaXRpb24sIG5leHRQb3NpdGlvbiwgYXR0YWNrQ2VsbCwgYm9hcmRTaXplID0gOCkge1xuICBjb25zdCBkaWZmQ29vcmRzID0gZGlzdGFuY2VYWShjdXJQb3NpdGlvbiwgbmV4dFBvc2l0aW9uLCBib2FyZFNpemUpO1xuICByZXR1cm4gZGlmZkNvb3Jkcy5kaWZmWCA8PSBhdHRhY2tDZWxsICYmIGRpZmZDb29yZHMuZGlmZlkgPD0gYXR0YWNrQ2VsbDtcbn1cbiIsImNvbnN0IHRoZW1lcyA9IHtcbiAgMTogJ3ByYWlyaWUnLFxuICAyOiAnZGVzZXJ0JyxcbiAgMzogJ2FyY3RpYycsXG4gIDQ6ICdtb3VudGFpbicsXG59O1xuXG5leHBvcnQgZGVmYXVsdCB0aGVtZXM7XG4iLCIvKipcbiAqINCR0LDQt9C+0LLRi9C5INC60LvQsNGB0YEsINC+0YIg0LrQvtGC0L7RgNC+0LPQviDQvdCw0YHQu9C10LTRg9GO0YLRgdGPINC60LvQsNGB0YHRiyDQv9C10YDRgdC+0L3QsNC20LXQuVxuICogQHByb3BlcnR5IGxldmVsIC0g0YPRgNC+0LLQtdC90Ywg0L/QtdGA0YHQvtC90LDQttCwLCDQvtGCIDEg0LTQviA0XG4gKiBAcHJvcGVydHkgYXR0YWNrIC0g0L/QvtC60LDQt9Cw0YLQtdC70Ywg0LDRgtCw0LrQuFxuICogQHByb3BlcnR5IGRlZmVuY2UgLSDQv9C+0LrQsNC30LDRgtC10LvRjCDQt9Cw0YnQuNGC0YtcbiAqIEBwcm9wZXJ0eSBoZWFsdGggLSDQt9C00L7RgNC+0LLRjNC1INC/0LXRgNGB0L7QvdCw0LbQsFxuICogQHByb3BlcnR5IHR5cGUgLSDRgdGC0YDQvtC60LAg0YEg0L7QtNC90LjQvCDQuNC3INC00L7Qv9GD0YHRgtC40LzRi9GFINC30L3QsNGH0LXQvdC40Lk6XG4gKiBzd29yZHNtYW5cbiAqIGJvd21hblxuICogbWFnaWNpYW5cbiAqIGRhZW1vblxuICogdW5kZWFkXG4gKiB2YW1waXJlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENoYXJhY3RlciB7XG4gIGNvbnN0cnVjdG9yKGxldmVsLCB0eXBlID0gJ2dlbmVyaWMnKSB7XG4gICAgaWYgKG5ldy50YXJnZXQubmFtZSA9PT0gJ0NoYXJhY3RlcicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBjYW4ndCBjcmVhdGUgQ2hhcmFjdGVyIGNsYXNzIGRpcmVjdGx5XCIpO1xuICAgIH1cbiAgICB0aGlzLmxldmVsID0gbGV2ZWw7XG4gICAgdGhpcy5hdHRhY2sgPSAwO1xuICAgIHRoaXMuZGVmZW5jZSA9IDA7XG4gICAgdGhpcy5oZWFsdGggPSA1MDtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgIC8vIFRPRE86INCy0YvQsdGA0L7RgdC40YLQtSDQuNGB0LrQu9GO0YfQtdC90LjQtSwg0LXRgdC70Lgg0LrRgtC+LdGC0L4g0LjRgdC/0L7Qu9GM0LfRg9C10YIgXCJuZXcgQ2hhcmFjdGVyKClcIiAtIERPTkVcbiAgfVxuXG4gIGRhbWFnZShwb2ludHMpIHtcbiAgICBpZiAodGhpcy5oZWFsdGggPiAwKSB7XG4gICAgICBpZiAodGhpcy5oZWFsdGggPD0gcG9pbnRzKSB7XG4gICAgICAgIHRoaXMuaGVhbHRoID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGVhbHRoIC09IHBvaW50cztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oZWFsdGggPSAwO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IENoYXJhY3RlciBmcm9tICcuL0NoYXJhY3Rlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvc2l0aW9uZWRDaGFyYWN0ZXIge1xuICBjb25zdHJ1Y3RvcihjaGFyYWN0ZXIsIHBvc2l0aW9uKSB7XG4gICAgaWYgKCEoY2hhcmFjdGVyIGluc3RhbmNlb2YgQ2hhcmFjdGVyKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjaGFyYWN0ZXIgbXVzdCBiZSBpbnN0YW5jZSBvZiBDaGFyYWN0ZXIgb3IgaXRzIGNoaWxkcmVuJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBwb3NpdGlvbiAhPT0gJ251bWJlcicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigncG9zaXRpb24gbXVzdCBiZSBhIG51bWJlcicpO1xuICAgIH1cblxuICAgIHRoaXMuY2hhcmFjdGVyID0gY2hhcmFjdGVyO1xuICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcbiAgfVxufVxuIiwiaW1wb3J0IFBvc2l0aW9uZWRDaGFyYWN0ZXIgZnJvbSAnLi9Qb3NpdGlvbmVkQ2hhcmFjdGVyJztcblxuLyoqXG4gKiDQpNGD0L3QutGG0LjRjyDQstC+0LfQstGA0LDRidCw0LXRgiDRgdC/0LjRgdC+0Log0LLRgdC10YUg0LLQvtC30LzQvtC20L3Ri9GFINGC0L7Rh9C10Log0L3QsCDQv9C+0LvQtSDQtNC70Y8g0YDQsNGB0L/QvtC70L7QttC10L3QuNGPINCz0LXRgNC+0LXQsiDQvtC/0YDQtdC00LXQu9C10L3QvdC+0LPQviDRgtC40L/QsFxuICogQHJldHVybnMg0LzQsNGB0YHQuNCyINCy0YHQtdGFINCy0L7Qt9C80L7QttC90YvRhSDQutC+0L7RgNC00LjQvdCw0YIg0YHQvtCz0LvQsNGB0L3QviDRg9GB0LvQvtCy0LjRj9C8INC30LDQtNCw0YfQuFxuICogKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxvd2VkQ29vcmRpbmF0ZXModHlwZVRlYW0sIGJvYXJkU2l6ZSA9IDgpIHtcbiAgY29uc3QgYWxsQ29vcmRzID0gWy4uLkFycmF5KGJvYXJkU2l6ZSAqKiAyKS5rZXlzKCldO1xuICBsZXQgYWxsb3dlZENvb3JkcztcblxuICBpZiAodHlwZVRlYW0gPT09ICdvcHBvbmVudCcpIHtcbiAgICBhbGxvd2VkQ29vcmRzID0gYWxsQ29vcmRzLmZpbHRlcigocG9zKSA9PiAocG9zICUgYm9hcmRTaXplID09PSA2IHx8IHBvcyAlIGJvYXJkU2l6ZSA9PT0gNykpO1xuICB9IGVsc2Uge1xuICAgIGFsbG93ZWRDb29yZHMgPSBhbGxDb29yZHMuZmlsdGVyKChwb3MpID0+IChwb3MgJSBib2FyZFNpemUgPT09IDAgfHwgcG9zICUgYm9hcmRTaXplID09PSAxKSk7XG4gIH1cbiAgcmV0dXJuIGFsbG93ZWRDb29yZHM7XG59XG5cbi8qKlxuICog0KTQvtGA0LzQuNGA0YPQtdGCINGN0LrQt9C10LzQv9C70Y/RgCDQv9C10YDRgdC+0L3QsNC20LAg0LjQtyDQvNCw0YHRgdC40LLQsCBhbGxvd2VkVHlwZXMg0YHQvlxuICog0YHQu9GD0YfQsNC50L3Ri9C8INGD0YDQvtCy0L3QtdC8INC+0YIgMSDQtNC+IG1heExldmVsXG4gKlxuICogQHBhcmFtIGFsbG93ZWRUeXBlcyDQvNCw0YHRgdC40LIg0LrQu9Cw0YHRgdC+0LJcbiAqIEBwYXJhbSBtYXhMZXZlbCDQvNCw0LrRgdC40LzQsNC70YzQvdGL0Lkg0LLQvtC30LzQvtC20L3Ri9C5INGD0YDQvtCy0LXQvdGMINC/0LXRgNGB0L7QvdCw0LbQsFxuICogQHJldHVybnMg0LPQtdC90LXRgNCw0YLQvtGALCDQutC+0YLQvtGA0YvQuSDQv9GA0Lgg0LrQsNC20LTQvtC8INCy0YvQt9C+0LLQtVxuICog0LLQvtC30LLRgNCw0YnQsNC10YIg0L3QvtCy0YvQuSDRjdC60LfQtdC80L/Qu9GP0YAg0LrQu9Cw0YHRgdCwINC/0LXRgNGB0L7QvdCw0LbQsFxuICpcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uKiBjaGFyYWN0ZXJHZW5lcmF0b3IoYWxsb3dlZFR5cGVzLCBtYXhMZXZlbCkge1xuICAvLyBUT0RPOiB3cml0ZSBsb2dpYyBoZXJlXG4gIHdoaWxlICh0cnVlKSB7XG4gICAgY29uc3QgclR5cGUgPSBNYXRoLmZsb29yKGFsbG93ZWRUeXBlcy5sZW5ndGggKiBNYXRoLnJhbmRvbSgpKTtcbiAgICBjb25zdCByTGV2ZWwgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXhMZXZlbCkgKyAxO1xuICAgIHlpZWxkIG5ldyBhbGxvd2VkVHlwZXNbclR5cGVdKHJMZXZlbCk7XG4gIH1cbn1cblxuLyoqXG4gKiDQpNC+0YDQvNC40YDRg9C10YIg0LzQsNGB0YHQuNCyINC/0LXRgNGB0L7QvdCw0LbQtdC5INC90LAg0L7RgdC90L7QstC1IGNoYXJhY3RlckdlbmVyYXRvclxuICogQHBhcmFtIGFsbG93ZWRUeXBlcyDQvNCw0YHRgdC40LIg0LrQu9Cw0YHRgdC+0LJcbiAqIEBwYXJhbSBtYXhMZXZlbCDQvNCw0LrRgdC40LzQsNC70YzQvdGL0Lkg0LLQvtC30LzQvtC20L3Ri9C5INGD0YDQvtCy0LXQvdGMINC/0LXRgNGB0L7QvdCw0LbQsFxuICogQHBhcmFtIGNoYXJhY3RlckNvdW50INC60L7Qu9C40YfQtdGB0YLQstC+INC/0LXRgNGB0L7QvdCw0LbQtdC5LCDQutC+0YLQvtGA0L7QtSDQvdGD0LbQvdC+INGB0YTQvtGA0LzQuNGA0L7QstCw0YLRjFxuICogQHJldHVybnMg0Y3QutC30LXQvNC/0LvRj9GAIFRlYW0sINGF0YDQsNC90Y/RidC40Lkg0Y3QutC30LXQvNC/0LvRj9GA0Ysg0L/QtdGA0YHQvtC90LDQttC10LkuXG4gKiDQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C10YDRgdC+0L3QsNC20LXQuSDQsiDQutC+0LzQsNC90LTQtSAtIGNoYXJhY3RlckNvdW50XG4gKiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVGVhbShhbGxvd2VkVHlwZXMsIG1heExldmVsLCBjaGFyYWN0ZXJDb3VudCkge1xuICAvLyBUT0RPOiB3cml0ZSBsb2dpYyBoZXJlXG4gIGNvbnN0IGJvYXJkU2l6ZSA9IDg7XG4gIGNvbnN0IG5ld1RlYW0gPSBbXTtcbiAgY29uc3QgcGxheWVyQ29vcmRzID0gZ2V0QWxsb3dlZENvb3JkaW5hdGVzKCdwbGF5ZXInLCBib2FyZFNpemUpO1xuICBjb25zdCBvcHBvbmVudENvb3JkcyA9IGdldEFsbG93ZWRDb29yZGluYXRlcygnb3Bwb25lbnQnLCBib2FyZFNpemUpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhcmFjdGVyQ291bnQ7IGkgKz0gMSkge1xuICAgIGNvbnN0IG5ld0NoYXJhY3RlciA9IGNoYXJhY3RlckdlbmVyYXRvcihhbGxvd2VkVHlwZXMsIG1heExldmVsKS5uZXh0KCkudmFsdWU7XG4gICAgbGV0IGluZGV4O1xuICAgIGxldCBwb3NpdGlvbjtcbiAgICBpZiAobmV3Q2hhcmFjdGVyLmlzR29vZENoYXJhY3Rlcikge1xuICAgICAgaW5kZXggPSBNYXRoLmZsb29yKHBsYXllckNvb3Jkcy5sZW5ndGggKiBNYXRoLnJhbmRvbSgpKTtcbiAgICAgIHBvc2l0aW9uID0gcGxheWVyQ29vcmRzW2luZGV4XTtcbiAgICAgIHBsYXllckNvb3Jkcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbmRleCA9IE1hdGguZmxvb3Iob3Bwb25lbnRDb29yZHMubGVuZ3RoICogTWF0aC5yYW5kb20oKSk7XG4gICAgICBwb3NpdGlvbiA9IG9wcG9uZW50Q29vcmRzW2luZGV4XTtcbiAgICAgIG9wcG9uZW50Q29vcmRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfVxuICAgIG5ld1RlYW0ucHVzaChuZXcgUG9zaXRpb25lZENoYXJhY3RlcihuZXdDaGFyYWN0ZXIsIHBvc2l0aW9uKSk7XG4gIH1cbiAgcmV0dXJuIG5ld1RlYW07XG59XG4iLCJpbXBvcnQgQ2hhcmFjdGVyIGZyb20gJy4uL0NoYXJhY3Rlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJvd21hbiBleHRlbmRzIENoYXJhY3RlciB7XG4gIGNvbnN0cnVjdG9yKGxldmVsKSB7XG4gICAgc3VwZXIobGV2ZWwsICdib3dtYW4nKTtcbiAgICB0aGlzLmF0dGFjayA9IDI1O1xuICAgIHRoaXMuZGVmZW5jZSA9IDI1O1xuICAgIHRoaXMubW92ZUNlbGwgPSAyO1xuICAgIHRoaXMuYXR0YWNrQ2VsbCA9IDI7XG4gICAgdGhpcy5pc0dvb2RDaGFyYWN0ZXIgPSB0cnVlO1xuICB9XG59XG4iLCJpbXBvcnQgQ2hhcmFjdGVyIGZyb20gJy4uL0NoYXJhY3Rlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERhZW1vbiBleHRlbmRzIENoYXJhY3RlciB7XG4gIGNvbnN0cnVjdG9yKGxldmVsKSB7XG4gICAgc3VwZXIobGV2ZWwsICdkYWVtb24nKTtcbiAgICB0aGlzLmF0dGFjayA9IDEwO1xuICAgIHRoaXMuZGVmZW5jZSA9IDQwO1xuICAgIHRoaXMubW92ZUNlbGwgPSAxO1xuICAgIHRoaXMuYXR0YWNrQ2VsbCA9IDQ7XG4gICAgdGhpcy5pc0dvb2RDaGFyYWN0ZXIgPSBmYWxzZTtcbiAgfVxufVxuIiwiaW1wb3J0IENoYXJhY3RlciBmcm9tICcuLi9DaGFyYWN0ZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYWdpY2lhbiBleHRlbmRzIENoYXJhY3RlciB7XG4gIGNvbnN0cnVjdG9yKGxldmVsKSB7XG4gICAgc3VwZXIobGV2ZWwsICdtYWdpY2lhbicpO1xuICAgIHRoaXMuYXR0YWNrID0gMTA7XG4gICAgdGhpcy5kZWZlbmNlID0gNDA7XG4gICAgdGhpcy5tb3ZlQ2VsbCA9IDE7XG4gICAgdGhpcy5hdHRhY2tDZWxsID0gNDtcbiAgICB0aGlzLmlzR29vZENoYXJhY3RlciA9IHRydWU7XG4gIH1cbn1cbiIsImltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi4vQ2hhcmFjdGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3dvcmRzbWFuIGV4dGVuZHMgQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IobGV2ZWwpIHtcbiAgICBzdXBlcihsZXZlbCwgJ3N3b3Jkc21hbicpO1xuICAgIHRoaXMuYXR0YWNrID0gNDA7XG4gICAgdGhpcy5kZWZlbmNlID0gMTA7XG4gICAgdGhpcy5tb3ZlQ2VsbCA9IDQ7XG4gICAgdGhpcy5hdHRhY2tDZWxsID0gMTtcbiAgICB0aGlzLmlzR29vZENoYXJhY3RlciA9IHRydWU7XG4gIH1cbn1cbiIsImltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi4vQ2hhcmFjdGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVW5kZWFkIGV4dGVuZHMgQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IobGV2ZWwpIHtcbiAgICBzdXBlcihsZXZlbCwgJ3VuZGVhZCcpO1xuICAgIHRoaXMuYXR0YWNrID0gNDA7XG4gICAgdGhpcy5kZWZlbmNlID0gMTA7XG4gICAgdGhpcy5tb3ZlQ2VsbCA9IDQ7XG4gICAgdGhpcy5hdHRhY2tDZWxsID0gMTtcbiAgICB0aGlzLmlzR29vZENoYXJhY3RlciA9IGZhbHNlO1xuICB9XG59XG4iLCJpbXBvcnQgQ2hhcmFjdGVyIGZyb20gJy4uL0NoYXJhY3Rlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZhbXBpcmUgZXh0ZW5kcyBDaGFyYWN0ZXIge1xuICBjb25zdHJ1Y3RvcihsZXZlbCkge1xuICAgIHN1cGVyKGxldmVsLCAndmFtcGlyZScpO1xuICAgIHRoaXMuYXR0YWNrID0gMjU7XG4gICAgdGhpcy5kZWZlbmNlID0gMjU7XG4gICAgdGhpcy5tb3ZlQ2VsbCA9IDI7XG4gICAgdGhpcy5hdHRhY2tDZWxsID0gMjtcbiAgICB0aGlzLmlzR29vZENoYXJhY3RlciA9IGZhbHNlO1xuICB9XG59XG4iLCIvKipcbiAqINCa0LvQsNGB0YEsINC/0YDQtdC00YHRgtCw0LLQu9GP0Y7RidC40Lkg0L/QtdGA0YHQvtC90LDQttC10Lkg0LrQvtC80LDQvdC00YtcbiAqXG4gKiBAdG9kbyDQodCw0LzQvtGB0YLQvtGP0YLQtdC70YzQvdC+INC/0YDQvtC00YPQvNCw0LnRgtC1INGF0YDQsNC90LXQvdC40LUg0L/QtdGA0YHQvtC90LDQttC10Lkg0LIg0LrQu9Cw0YHRgdC1XG4gKiDQndCw0L/RgNC40LzQtdGAXG4gKiBAZXhhbXBsZVxuICogYGBganNcbiAqIGNvbnN0IGNoYXJhY3RlcnMgPSBbbmV3IFN3b3Jkc21hbigyKSwgbmV3IEJvd21hbigxKV1cbiAqIGNvbnN0IHRlYW0gPSBuZXcgVGVhbShjaGFyYWN0ZXJzKTtcbiAqXG4gKiB0ZWFtLmNoYXJhY3RlcnMgLy8gW3N3b3Jkc21hbiwgYm93bWFuXVxuICogYGBgXG4gKiAqL1xuXG5pbXBvcnQgQm93bWFuIGZyb20gJy4vY2hhcmFjdGVycy9Cb3dtYW4nO1xuaW1wb3J0IERhZW1vbiBmcm9tICcuL2NoYXJhY3RlcnMvRGFlbW9uJztcbmltcG9ydCBNYWdpY2lhbiBmcm9tICcuL2NoYXJhY3RlcnMvTWFnaWNpYW4nO1xuaW1wb3J0IFN3b3Jkc21hbiBmcm9tICcuL2NoYXJhY3RlcnMvU3dvcmRzbWFuJztcbmltcG9ydCBVbmRlYWQgZnJvbSAnLi9jaGFyYWN0ZXJzL1VuZGVhZCc7XG5pbXBvcnQgVmFtcGlyZSBmcm9tICcuL2NoYXJhY3RlcnMvVmFtcGlyZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRlYW0ge1xuICAvLyBUT0RPOiB3cml0ZSB5b3VyIGxvZ2ljIGhlcmVcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5wbGF5ZXJUZWFtID0gW0Jvd21hbiwgU3dvcmRzbWFuLCBNYWdpY2lhbl07XG4gICAgdGhpcy5vcHBvbmVudFRlYW0gPSBbRGFlbW9uLCBVbmRlYWQsIFZhbXBpcmVdO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lU3RhdGUge1xuICBjb25zdHJ1Y3RvcihwbGF5ZXJUZWFtLCBvcHBvbmVudFRlYW0pIHtcbiAgICB0aGlzLnBsYXllclRlYW0gPSBwbGF5ZXJUZWFtO1xuICAgIHRoaXMub3Bwb25lbnRUZWFtID0gb3Bwb25lbnRUZWFtO1xuICAgIHRoaXMucGxheWVyTW92ZSA9IHRydWU7XG4gIH1cblxuICBzdGF0aWMgZnJvbShvYmplY3QpIHtcbiAgICAvLyBUT0RPOiBjcmVhdGUgb2JqZWN0XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiIsImNvbnN0IGN1cnNvcnMgPSB7XG4gIGF1dG86ICdhdXRvJyxcbiAgcG9pbnRlcjogJ3BvaW50ZXInLFxuICBjcm9zc2hhaXI6ICdjcm9zc2hhaXInLFxuICBub3RhbGxvd2VkOiAnbm90LWFsbG93ZWQnLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY3Vyc29ycztcbiIsIi8qKlxuICogRW50cnkgcG9pbnQgb2YgYXBwOiBkb24ndCBjaGFuZ2UgdGhpc1xuICovXG5pbXBvcnQgR2FtZVBsYXkgZnJvbSAnLi9HYW1lUGxheSc7XG5pbXBvcnQgR2FtZUNvbnRyb2xsZXIgZnJvbSAnLi9HYW1lQ29udHJvbGxlcic7XG5pbXBvcnQgR2FtZVN0YXRlU2VydmljZSBmcm9tICcuL0dhbWVTdGF0ZVNlcnZpY2UnO1xuXG5jb25zdCBnYW1lUGxheSA9IG5ldyBHYW1lUGxheSgpO1xuZ2FtZVBsYXkuYmluZFRvRE9NKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnYW1lLWNvbnRhaW5lcicpKTtcblxuY29uc3Qgc3RhdGVTZXJ2aWNlID0gbmV3IEdhbWVTdGF0ZVNlcnZpY2UobG9jYWxTdG9yYWdlKTtcblxuY29uc3QgZ2FtZUN0cmwgPSBuZXcgR2FtZUNvbnRyb2xsZXIoZ2FtZVBsYXksIHN0YXRlU2VydmljZSk7XG5nYW1lQ3RybC5pbml0KCk7XG5cbi8vIGRvbid0IHdyaXRlIHlvdXIgY29kZSBoZXJlXG4iLCJpbXBvcnQgeyBjYWxjSGVhbHRoTGV2ZWwsIGNhbGNUaWxlVHlwZSB9IGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lUGxheSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYm9hcmRTaXplID0gODtcbiAgICB0aGlzLmNvbnRhaW5lciA9IG51bGw7XG4gICAgdGhpcy5ib2FyZEVsID0gbnVsbDtcbiAgICB0aGlzLmNlbGxzID0gW107XG4gICAgdGhpcy5jZWxsQ2xpY2tMaXN0ZW5lcnMgPSBbXTtcbiAgICB0aGlzLmNlbGxFbnRlckxpc3RlbmVycyA9IFtdO1xuICAgIHRoaXMuY2VsbExlYXZlTGlzdGVuZXJzID0gW107XG4gICAgdGhpcy5uZXdHYW1lTGlzdGVuZXJzID0gW107XG4gICAgdGhpcy5zYXZlR2FtZUxpc3RlbmVycyA9IFtdO1xuICAgIHRoaXMubG9hZEdhbWVMaXN0ZW5lcnMgPSBbXTtcbiAgfVxuXG4gIGJpbmRUb0RPTShjb250YWluZXIpIHtcbiAgICBpZiAoIShjb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY29udGFpbmVyIGlzIG5vdCBIVE1MRWxlbWVudCcpO1xuICAgIH1cbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBEcmF3cyBib2FyZEVsIHdpdGggc3BlY2lmaWMgdGhlbWVcbiAgICpcbiAgICogQHBhcmFtIHRoZW1lXG4gICAqL1xuICBkcmF3VWkodGhlbWUpIHtcbiAgICB0aGlzLmNoZWNrQmluZGluZygpO1xuXG4gICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gYFxuICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+XG4gICAgICAgIDxidXR0b24gZGF0YS1pZD1cImFjdGlvbi1yZXN0YXJ0XCIgY2xhc3M9XCJidG5cIj5OZXcgR2FtZTwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGRhdGEtaWQ9XCJhY3Rpb24tc2F2ZVwiIGNsYXNzPVwiYnRuXCI+U2F2ZSBHYW1lPC9idXR0b24+XG4gICAgICAgIDxidXR0b24gZGF0YS1pZD1cImFjdGlvbi1sb2FkXCIgY2xhc3M9XCJidG5cIj5Mb2FkIEdhbWU8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImJvYXJkLWNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGRhdGEtaWQ9XCJib2FyZFwiIGNsYXNzPVwiYm9hcmRcIj48L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIGA7XG5cbiAgICB0aGlzLm5ld0dhbWVFbCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPWFjdGlvbi1yZXN0YXJ0XScpO1xuICAgIHRoaXMuc2F2ZUdhbWVFbCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPWFjdGlvbi1zYXZlXScpO1xuICAgIHRoaXMubG9hZEdhbWVFbCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPWFjdGlvbi1sb2FkXScpO1xuXG4gICAgdGhpcy5uZXdHYW1lRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHRoaXMub25OZXdHYW1lQ2xpY2soZXZlbnQpKTtcbiAgICB0aGlzLnNhdmVHYW1lRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHRoaXMub25TYXZlR2FtZUNsaWNrKGV2ZW50KSk7XG4gICAgdGhpcy5sb2FkR2FtZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB0aGlzLm9uTG9hZEdhbWVDbGljayhldmVudCkpO1xuXG4gICAgdGhpcy5ib2FyZEVsID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtaWQ9Ym9hcmRdJyk7XG5cbiAgICB0aGlzLmJvYXJkRWwuY2xhc3NMaXN0LmFkZCh0aGVtZSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZSAqKiAyOyBpICs9IDEpIHtcbiAgICAgIGNvbnN0IGNlbGxFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgY2VsbEVsLmNsYXNzTGlzdC5hZGQoJ2NlbGwnLCAnbWFwLXRpbGUnLCBgbWFwLXRpbGUtJHtjYWxjVGlsZVR5cGUoaSwgdGhpcy5ib2FyZFNpemUpfWApO1xuICAgICAgY2VsbEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoZXZlbnQpID0+IHRoaXMub25DZWxsRW50ZXIoZXZlbnQpKTtcbiAgICAgIGNlbGxFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKGV2ZW50KSA9PiB0aGlzLm9uQ2VsbExlYXZlKGV2ZW50KSk7XG4gICAgICBjZWxsRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHRoaXMub25DZWxsQ2xpY2soZXZlbnQpKTtcbiAgICAgIHRoaXMuYm9hcmRFbC5hcHBlbmRDaGlsZChjZWxsRWwpO1xuICAgIH1cblxuICAgIHRoaXMuY2VsbHMgPSBBcnJheS5mcm9tKHRoaXMuYm9hcmRFbC5jaGlsZHJlbik7XG4gIH1cblxuICAvKipcbiAgICogRHJhd3MgcG9zaXRpb25zICh3aXRoIGNoYXJzKSBvbiBib2FyZEVsXG4gICAqXG4gICAqIEBwYXJhbSBwb3NpdGlvbnMgYXJyYXkgb2YgUG9zaXRpb25lZENoYXJhY3RlciBvYmplY3RzXG4gICAqL1xuICByZWRyYXdQb3NpdGlvbnMocG9zaXRpb25zKSB7XG4gICAgZm9yIChjb25zdCBjZWxsIG9mIHRoaXMuY2VsbHMpIHtcbiAgICAgIGNlbGwuaW5uZXJIVE1MID0gJyc7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBwb3NpdGlvbiBvZiBwb3NpdGlvbnMpIHtcbiAgICAgIGNvbnN0IGNlbGxFbCA9IHRoaXMuYm9hcmRFbC5jaGlsZHJlbltwb3NpdGlvbi5wb3NpdGlvbl07XG4gICAgICBjb25zdCBjaGFyRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGNoYXJFbC5jbGFzc0xpc3QuYWRkKCdjaGFyYWN0ZXInLCBwb3NpdGlvbi5jaGFyYWN0ZXIudHlwZSk7XG5cbiAgICAgIGNvbnN0IGhlYWx0aEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBoZWFsdGhFbC5jbGFzc0xpc3QuYWRkKCdoZWFsdGgtbGV2ZWwnKTtcblxuICAgICAgY29uc3QgaGVhbHRoSW5kaWNhdG9yRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGhlYWx0aEluZGljYXRvckVsLmNsYXNzTGlzdC5hZGQoJ2hlYWx0aC1sZXZlbC1pbmRpY2F0b3InLCBgaGVhbHRoLWxldmVsLWluZGljYXRvci0ke2NhbGNIZWFsdGhMZXZlbChwb3NpdGlvbi5jaGFyYWN0ZXIuaGVhbHRoKX1gKTtcbiAgICAgIGhlYWx0aEluZGljYXRvckVsLnN0eWxlLndpZHRoID0gYCR7cG9zaXRpb24uY2hhcmFjdGVyLmhlYWx0aH0lYDtcbiAgICAgIGhlYWx0aEVsLmFwcGVuZENoaWxkKGhlYWx0aEluZGljYXRvckVsKTtcblxuICAgICAgY2hhckVsLmFwcGVuZENoaWxkKGhlYWx0aEVsKTtcbiAgICAgIGNlbGxFbC5hcHBlbmRDaGlsZChjaGFyRWwpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgbGlzdGVuZXIgdG8gbW91c2UgZW50ZXIgZm9yIGNlbGxcbiAgICpcbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBhZGRDZWxsRW50ZXJMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIHRoaXMuY2VsbEVudGVyTGlzdGVuZXJzLnB1c2goY2FsbGJhY2spO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBsaXN0ZW5lciB0byBtb3VzZSBsZWF2ZSBmb3IgY2VsbFxuICAgKlxuICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICovXG4gIGFkZENlbGxMZWF2ZUxpc3RlbmVyKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5jZWxsTGVhdmVMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGxpc3RlbmVyIHRvIG1vdXNlIGNsaWNrIGZvciBjZWxsXG4gICAqXG4gICAqIEBwYXJhbSBjYWxsYmFja1xuICAgKi9cbiAgYWRkQ2VsbENsaWNrTGlzdGVuZXIoY2FsbGJhY2spIHtcbiAgICB0aGlzLmNlbGxDbGlja0xpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgbGlzdGVuZXIgdG8gXCJOZXcgR2FtZVwiIGJ1dHRvbiBjbGlja1xuICAgKlxuICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICovXG4gIGFkZE5ld0dhbWVMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIHRoaXMubmV3R2FtZUxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgbGlzdGVuZXIgdG8gXCJTYXZlIEdhbWVcIiBidXR0b24gY2xpY2tcbiAgICpcbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBhZGRTYXZlR2FtZUxpc3RlbmVyKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5zYXZlR2FtZUxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgbGlzdGVuZXIgdG8gXCJMb2FkIEdhbWVcIiBidXR0b24gY2xpY2tcbiAgICpcbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBhZGRMb2FkR2FtZUxpc3RlbmVyKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5sb2FkR2FtZUxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgfVxuXG4gIG9uQ2VsbEVudGVyKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2VsbHMuaW5kZXhPZihldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICB0aGlzLmNlbGxFbnRlckxpc3RlbmVycy5mb3JFYWNoKChvKSA9PiBvLmNhbGwobnVsbCwgaW5kZXgpKTtcbiAgfVxuXG4gIG9uQ2VsbExlYXZlKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY2VsbHMuaW5kZXhPZihldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICB0aGlzLmNlbGxMZWF2ZUxpc3RlbmVycy5mb3JFYWNoKChvKSA9PiBvLmNhbGwobnVsbCwgaW5kZXgpKTtcbiAgfVxuXG4gIG9uQ2VsbENsaWNrKGV2ZW50KSB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmNlbGxzLmluZGV4T2YoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgdGhpcy5jZWxsQ2xpY2tMaXN0ZW5lcnMuZm9yRWFjaCgobykgPT4gby5jYWxsKG51bGwsIGluZGV4KSk7XG4gIH1cblxuICBvbk5ld0dhbWVDbGljayhldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5uZXdHYW1lTGlzdGVuZXJzLmZvckVhY2goKG8pID0+IG8uY2FsbChudWxsKSk7XG4gIH1cblxuICBvblNhdmVHYW1lQ2xpY2soZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuc2F2ZUdhbWVMaXN0ZW5lcnMuZm9yRWFjaCgobykgPT4gby5jYWxsKG51bGwpKTtcbiAgfVxuXG4gIG9uTG9hZEdhbWVDbGljayhldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5sb2FkR2FtZUxpc3RlbmVycy5mb3JFYWNoKChvKSA9PiBvLmNhbGwobnVsbCkpO1xuICB9XG5cbiAgc3RhdGljIHNob3dFcnJvcihtZXNzYWdlKSB7XG4gICAgYWxlcnQobWVzc2FnZSk7XG4gIH1cblxuICBzdGF0aWMgc2hvd01lc3NhZ2UobWVzc2FnZSkge1xuICAgIGFsZXJ0KG1lc3NhZ2UpO1xuICB9XG5cbiAgc2VsZWN0Q2VsbChpbmRleCwgY29sb3IgPSAneWVsbG93Jykge1xuICAgIHRoaXMuZGVzZWxlY3RDZWxsKGluZGV4KTtcbiAgICB0aGlzLmNlbGxzW2luZGV4XS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcsIGBzZWxlY3RlZC0ke2NvbG9yfWApO1xuICB9XG5cbiAgZGVzZWxlY3RDZWxsKGluZGV4KSB7XG4gICAgY29uc3QgY2VsbCA9IHRoaXMuY2VsbHNbaW5kZXhdO1xuICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSguLi5BcnJheS5mcm9tKGNlbGwuY2xhc3NMaXN0KVxuICAgICAgLmZpbHRlcigobykgPT4gby5zdGFydHNXaXRoKCdzZWxlY3RlZCcpKSk7XG4gIH1cblxuICBzaG93Q2VsbFRvb2x0aXAobWVzc2FnZSwgaW5kZXgpIHtcbiAgICB0aGlzLmNlbGxzW2luZGV4XS50aXRsZSA9IG1lc3NhZ2U7XG4gIH1cblxuICBoaWRlQ2VsbFRvb2x0aXAoaW5kZXgpIHtcbiAgICB0aGlzLmNlbGxzW2luZGV4XS50aXRsZSA9ICcnO1xuICB9XG5cbiAgc2hvd0RhbWFnZShpbmRleCwgZGFtYWdlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCBjZWxsID0gdGhpcy5jZWxsc1tpbmRleF07XG4gICAgICBjb25zdCBkYW1hZ2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIGRhbWFnZUVsLnRleHRDb250ZW50ID0gZGFtYWdlO1xuICAgICAgZGFtYWdlRWwuY2xhc3NMaXN0LmFkZCgnZGFtYWdlJyk7XG4gICAgICBjZWxsLmFwcGVuZENoaWxkKGRhbWFnZUVsKTtcblxuICAgICAgZGFtYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcignYW5pbWF0aW9uZW5kJywgKCkgPT4ge1xuICAgICAgICBjZWxsLnJlbW92ZUNoaWxkKGRhbWFnZUVsKTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBzZXRDdXJzb3IoY3Vyc29yKSB7XG4gICAgdGhpcy5ib2FyZEVsLnN0eWxlLmN1cnNvciA9IGN1cnNvcjtcbiAgfVxuXG4gIGNoZWNrQmluZGluZygpIHtcbiAgICBpZiAodGhpcy5jb250YWluZXIgPT09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignR2FtZVBsYXkgbm90IGJpbmQgdG8gRE9NJyk7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lU3RhdGVTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3Ioc3RvcmFnZSkge1xuICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gIH1cblxuICBzYXZlKHN0YXRlKSB7XG4gICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oJ3N0YXRlJywgSlNPTi5zdHJpbmdpZnkoc3RhdGUpKTtcbiAgfVxuXG4gIGxvYWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMuc3RvcmFnZS5nZXRJdGVtKCdzdGF0ZScpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RhdGUnKTtcbiAgICB9XG4gIH1cbn1cbiIsIi8vIEB0cy1ub2NoZWNrXG5cbmltcG9ydCB0aGVtZXMgZnJvbSAnLi90aGVtZXMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVUZWFtLCBnZXRBbGxvd2VkQ29vcmRpbmF0ZXMgfSBmcm9tICcuL2dlbmVyYXRvcnMnO1xuaW1wb3J0IFRlYW0gZnJvbSAnLi9UZWFtJztcbmltcG9ydCBHYW1lU3RhdGUgZnJvbSAnLi9HYW1lU3RhdGUnO1xuaW1wb3J0IEdhbWVQbGF5IGZyb20gJy4vR2FtZVBsYXknO1xuaW1wb3J0IGN1cnNvcnMgZnJvbSAnLi9jdXJzb3JzJztcbmltcG9ydCB7IHBvc3NpYmxlQXR0YWNrLCBwb3NzaWJsZU1vdmUgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi9DaGFyYWN0ZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKGdhbWVQbGF5LCBzdGF0ZVNlcnZpY2UpIHtcbiAgICB0aGlzLmdhbWVQbGF5ID0gZ2FtZVBsYXk7XG4gICAgdGhpcy5zdGF0ZVNlcnZpY2UgPSBzdGF0ZVNlcnZpY2U7XG4gICAgdGhpcy5wbGF5ZXJUZWFtID0gZ2VuZXJhdGVUZWFtKG5ldyBUZWFtKCkucGxheWVyVGVhbSwgMSwgMyk7XG4gICAgdGhpcy5vcHBvbmVudFRlYW0gPSBnZW5lcmF0ZVRlYW0obmV3IFRlYW0oKS5vcHBvbmVudFRlYW0sIDEsIDMpO1xuICAgIHRoaXMuZ2FtZVN0YXRlID0gbmV3IEdhbWVTdGF0ZSh0aGlzLnBsYXllclRlYW0sIHRoaXMub3Bwb25lbnRUZWFtKTtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgLy8gVE9ETzogYWRkIGV2ZW50IGxpc3RlbmVycyB0byBnYW1lUGxheSBldmVudHNcbiAgICAvLyBUT0RPOiBsb2FkIHNhdmVkIHN0YXRlZCBmcm9tIHN0YXRlU2VydmljZVxuICAgIHRoaXMuZ2FtZVBsYXkuZHJhd1VpKHRoZW1lc1sxXSk7XG4gICAgdGhpcy5nYW1lUGxheS5yZWRyYXdQb3NpdGlvbnMoWy4uLnRoaXMucGxheWVyVGVhbSwgLi4udGhpcy5vcHBvbmVudFRlYW1dKTtcbiAgICB0aGlzLmVudGVyT25DZWxsKCk7XG4gICAgdGhpcy5sZWF2ZU9uQ2VsbCgpO1xuICAgIHRoaXMuY2xpY2tPbkNlbGwoKTtcbiAgfVxuXG4gIG9uQ2VsbENsaWNrKGluZGV4KSB7XG4gICAgLy8gVE9ETzogcmVhY3QgdG8gY2xpY2tcbiAgICAvLyBDbGVhciAnc2VsZWN0ZWQteWVsbG93JyB3aGVuIGNsaWNrIG9uIG15c2VsZlxuICAgIGlmICh0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3RlciAmJiB0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlci5wb3NpdGlvbiA9PT0gaW5kZXgpIHtcbiAgICAgIHRoaXMuZ2FtZVBsYXkuZGVzZWxlY3RDZWxsKGluZGV4KTtcbiAgICAgIHRoaXMuZ2FtZVN0YXRlLnNlbGVjdGVkQ2hhcmFjdGVyID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ2xlYXIgJ3NlbGVjdGVkLXllbGxvdycgd2hlbiBjbGljayBvbiBhbm90aGVyIGZpZWxkIHdpdGggQ2hhcmFjdGVyIG9mIFBsYXllclxuICAgICAgY29uc3QgaXNDaGFyYWN0ZXIgPSB0aGlzLmhhc0NoYXJhY3RlcihpbmRleCk7XG4gICAgICBjb25zdCBwZXJzb24gPSB0aGlzLmdldENoYXJhY3RlcihpbmRleCk7XG4gICAgICBpZiAoaXNDaGFyYWN0ZXIpIHtcbiAgICAgICAgaWYgKHBlcnNvbi5jaGFyYWN0ZXIuaXNHb29kQ2hhcmFjdGVyKSB7XG4gICAgICAgICAgdGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIgPSBwZXJzb247XG4gICAgICAgICAgdGhpcy5nYW1lUGxheS5jZWxscy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoLi4uQXJyYXkuZnJvbShlbGVtZW50LmNsYXNzTGlzdClcbiAgICAgICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5zdGFydHNXaXRoKCdzZWxlY3RlZCcpKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5nYW1lUGxheS5zZWxlY3RDZWxsKGluZGV4KTtcbiAgICAgICAgICB0aGlzLmdhbWVQbGF5LnNldEN1cnNvcihjdXJzb3JzLnBvaW50ZXIpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vINCV0YHQu9C4INC80L7QttC10Lwg0L/QtdGA0LXQvNC10YHRgtC40YLRjCDQv9C10YDRgdC+0L3QsNC20LAg0L3QsCDQv9GD0YHRgtGD0Y4g0LrQu9C10YLQutGDXG4gICAgICBpZiAodGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIgJiYgIWlzQ2hhcmFjdGVyKSB7XG4gICAgICAgIGNvbnN0IG1vdmVEaXN0YW5jZSA9IHRoaXMuZ2FtZVN0YXRlLnNlbGVjdGVkQ2hhcmFjdGVyLmNoYXJhY3Rlci5tb3ZlQ2VsbDtcbiAgICAgICAgY29uc3QgcG9zaXRpb25DaGFyYWN0ZXIgPSB0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlci5wb3NpdGlvbjtcbiAgICAgICAgY29uc3QgcG9zTW92ZSA9IHBvc3NpYmxlTW92ZShwb3NpdGlvbkNoYXJhY3RlciwgaW5kZXgsIG1vdmVEaXN0YW5jZSk7XG4gICAgICAgIGlmIChwb3NNb3ZlKSB7XG4gICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyVGVhbSA9IHRoaXMuZmlsdGVyVGVhbSh0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlcik7XG4gICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyVGVhbSA9IFsuLi50aGlzLmdhbWVTdGF0ZS5wbGF5ZXJUZWFtLCB0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlcl07XG4gICAgICAgICAgdGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIucG9zaXRpb24gPSBpbmRleDtcbiAgICAgICAgICB0aGlzLmVuZE1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyDQldGB0LvQuCDQvNC+0LbQtdC8INCw0YLQsNC60L7QstCw0YLRjCDQv9C10YDRgdC+0L3QsNC20LAg0YEg0L/RgNC+0YLQuNCy0L7Qv9C+0LvQvtC20L3QvtC5INC60L7QvNCw0L3QtNGLXG4gICAgICBpZiAodGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIgJiYgaXNDaGFyYWN0ZXIpIHtcbiAgICAgICAgY29uc3QgYXR0YWNrRGlzdGFuY2UgPSB0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlci5jaGFyYWN0ZXIuYXR0YWNrQ2VsbDtcbiAgICAgICAgY29uc3QgcG9zaXRpb25DaGFyYWN0ZXIgPSB0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlci5wb3NpdGlvbjtcbiAgICAgICAgY29uc3QgcG9zQXR0YWNrID0gcG9zc2libGVBdHRhY2socG9zaXRpb25DaGFyYWN0ZXIsIGluZGV4LCBhdHRhY2tEaXN0YW5jZSk7XG4gICAgICAgIGlmIChwb3NBdHRhY2sgJiYgcG9zaXRpb25DaGFyYWN0ZXIgIT09IGluZGV4KSB7XG4gICAgICAgICAgdGhpcy5hdHRhY2tDaGFyYWN0ZXIodGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIsIHBlcnNvbik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBvbkNlbGxFbnRlcihpbmRleCkge1xuICAgIC8vIFRPRE86IHJlYWN0IHRvIG1vdXNlIGVudGVyXG4gICAgY29uc3QgaXNDaGFyYWN0ZXIgPSB0aGlzLmhhc0NoYXJhY3RlcihpbmRleCk7XG4gICAgY29uc3QgcGVyc29uID0gdGhpcy5nZXRDaGFyYWN0ZXIoaW5kZXgpO1xuICAgIGlmIChpc0NoYXJhY3Rlcikge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGBcXHV7MUYzOTZ9JHtwZXJzb24uY2hhcmFjdGVyLmxldmVsfSBcXHV7MUY1RTF9JHtwZXJzb24uY2hhcmFjdGVyLmF0dGFja30gXFx1ezFGNkUxfSR7cGVyc29uLmNoYXJhY3Rlci5kZWZlbmNlfSBcXHV7MUY0OTN9JHtwZXJzb24uY2hhcmFjdGVyLmhlYWx0aH1gO1xuICAgICAgdGhpcy5nYW1lUGxheS5zaG93Q2VsbFRvb2x0aXAobWVzc2FnZSwgaW5kZXgpO1xuICAgIH1cbiAgICAvLyDQktGL0LHRgNCw0L0g0L/QtdGA0YHQvtC90LDQtiDQuCDRj9GH0LXQudC60LAg0L3QsNC30L3QsNGH0LXQvdC40Y8g0L/Rg9GB0YLQsNGPXG4gICAgaWYgKHRoaXMuZ2FtZVN0YXRlLnNlbGVjdGVkQ2hhcmFjdGVyICYmICFpc0NoYXJhY3Rlcikge1xuICAgICAgY29uc3QgbW92ZURpc3RhbmNlID0gdGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIuY2hhcmFjdGVyLm1vdmVDZWxsO1xuICAgICAgaWYgKHBvc3NpYmxlTW92ZSh0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlci5wb3NpdGlvbiwgaW5kZXgsIG1vdmVEaXN0YW5jZSkpIHtcbiAgICAgICAgdGhpcy5nYW1lUGxheS5zZWxlY3RDZWxsKGluZGV4LCAnZ3JlZW4nKTtcbiAgICAgICAgdGhpcy5nYW1lUGxheS5zZXRDdXJzb3IoY3Vyc29ycy5wb2ludGVyKTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8g0JLRi9Cx0YDQsNC9INC/0LXRgNGB0L7QvdCw0LYg0Lgg0LIg0L3QvtCy0L7QuSDQutC70LXRgtC60LUg0L3QsNGF0L7QtNC40YLRgdGPINC/0LXRgNGB0L7QvdCw0LYg0L/RgNC+0YLQuNCy0L7Qv9C+0LvQvtC20L3QvtC5INC60L7QvNCw0L3QtNGLXG4gICAgaWYgKGlzQ2hhcmFjdGVyKSB7XG4gICAgICBpZiAodGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIgJiYgIXBlcnNvbi5jaGFyYWN0ZXIuaXNHb29kQ2hhcmFjdGVyKSB7XG4gICAgICAgIGNvbnN0IGF0dGFja0Rpc3RhbmNlID0gdGhpcy5nYW1lU3RhdGUuc2VsZWN0ZWRDaGFyYWN0ZXIuY2hhcmFjdGVyLmF0dGFja0NlbGw7XG4gICAgICAgIGlmIChwb3NzaWJsZUF0dGFjayh0aGlzLmdhbWVTdGF0ZS5zZWxlY3RlZENoYXJhY3Rlci5wb3NpdGlvbiwgaW5kZXgsIGF0dGFja0Rpc3RhbmNlKSkge1xuICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuc2VsZWN0Q2VsbChpbmRleCwgJ3JlZCcpO1xuICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuc2V0Q3Vyc29yKGN1cnNvcnMuY3Jvc3NoYWlyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmdhbWVQbGF5LnNldEN1cnNvcihjdXJzb3JzLm5vdGFsbG93ZWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgb25DZWxsTGVhdmUoaW5kZXgpIHtcbiAgICAvLyBUT0RPOiByZWFjdCB0byBtb3VzZSBsZWF2ZVxuICAgIHRoaXMuZ2FtZVBsYXkuc2V0Q3Vyc29yKGN1cnNvcnMucG9pbnRlcik7XG4gICAgdGhpcy5nYW1lUGxheS5jZWxscy5mb3JFYWNoKChjZWxsKSA9PiBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkLWdyZWVuJywgJ3NlbGVjdGVkLXJlZCcpKTtcbiAgICB0aGlzLmdhbWVQbGF5LmhpZGVDZWxsVG9vbHRpcChpbmRleCk7XG4gIH1cblxuICBoYXNDaGFyYWN0ZXIoaW5kZXgpIHtcbiAgICBjb25zdCBhbGxDaGFyYWN0ZXJzID0gWy4uLnRoaXMucGxheWVyVGVhbSwgLi4udGhpcy5vcHBvbmVudFRlYW1dO1xuICAgIHJldHVybiBhbGxDaGFyYWN0ZXJzLnNvbWUoKHBlcnNvbikgPT4gcGVyc29uLnBvc2l0aW9uID09PSBpbmRleCk7XG4gIH1cblxuICBnZXRDaGFyYWN0ZXIoaW5kZXgpIHtcbiAgICBsZXQgcmVzdWx0ID0gdGhpcy5wbGF5ZXJUZWFtLmZpbmQoKHBlcnNvbikgPT4gcGVyc29uLnBvc2l0aW9uID09PSBpbmRleCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgIHJlc3VsdCA9IHRoaXMub3Bwb25lbnRUZWFtLmZpbmQoKHBlcnNvbikgPT4gcGVyc29uLnBvc2l0aW9uID09PSBpbmRleCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBlbnRlck9uQ2VsbCgpIHtcbiAgICB0aGlzLmdhbWVQbGF5LmFkZENlbGxFbnRlckxpc3RlbmVyKHRoaXMub25DZWxsRW50ZXIuYmluZCh0aGlzKSk7XG4gIH1cblxuICBsZWF2ZU9uQ2VsbCgpIHtcbiAgICB0aGlzLmdhbWVQbGF5LmFkZENlbGxMZWF2ZUxpc3RlbmVyKHRoaXMub25DZWxsTGVhdmUuYmluZCh0aGlzKSk7XG4gIH1cblxuICBjbGlja09uQ2VsbCgpIHtcbiAgICB0aGlzLmdhbWVQbGF5LmFkZENlbGxDbGlja0xpc3RlbmVyKHRoaXMub25DZWxsQ2xpY2suYmluZCh0aGlzKSk7XG4gIH1cblxuICAvLyDQpNGD0L3QutGG0LjRjyDRhNC40LvRjNGC0YDQsNGG0LjQuCDQs9C10YDQvtC10LIg0Lgg0YPQtNCw0LvQtdC90LjRjyDRgtC+0LPQviwg0LrQvtGC0L7RgNGL0Lkg0L/QtdGA0LXQvNC10YHRgtC40LvRgdGPXG4gIGZpbHRlclRlYW0ocGVyc29uKSB7XG4gICAgbGV0IHJlc3VsdDtcbiAgICBpZiAocGVyc29uLmNoYXJhY3Rlci5pc0dvb2RDaGFyYWN0ZXIpIHtcbiAgICAgIHJlc3VsdCA9IHRoaXMuZ2FtZVN0YXRlLnBsYXllclRlYW0uZmlsdGVyKChlbGVtKSA9PiBlbGVtLnBvc2l0aW9uICE9PSBwZXJzb24ucG9zaXRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQgPSB0aGlzLmdhbWVTdGF0ZS5vcHBvbmVudFRlYW0uZmlsdGVyKChlbGVtKSA9PiBlbGVtLnBvc2l0aW9uICE9PSBwZXJzb24ucG9zaXRpb24pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8g0KTRg9C90LrRhtC40Y8g0LfQsNCy0LXRgNGI0LXQvdC40Y8g0YXQvtC00LAg0LjQs9GA0L7QutCwXG4gIGVuZE1vdmUoKSB7XG4gICAgdGhpcy5nYW1lUGxheS5jZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoLi4uQXJyYXkuZnJvbShjZWxsLmNsYXNzTGlzdClcbiAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5zdGFydHNXaXRoKCdzZWxlY3RlZCcpKSk7XG4gICAgfSk7XG4gICAgdGhpcy5nYW1lUGxheS5yZWRyYXdQb3NpdGlvbnMoWy4uLnRoaXMuZ2FtZVN0YXRlLnBsYXllclRlYW0sIC4uLnRoaXMuZ2FtZVN0YXRlLm9wcG9uZW50VGVhbV0pO1xuICAgIGlmICh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXJNb3ZlKSB7XG4gICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXJNb3ZlID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllck1vdmUgPSB0cnVlO1xuICAgIH1cbiAgICAvLyBjb25zb2xlLmxvZygnTW92ZT8nLCB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXJNb3ZlKTtcbiAgfVxuXG4gIC8vINCk0YPQvdC60YbQuNGPINGA0LDRgdGH0LXRgtCwINCw0YLQsNC60Lgg0L/QtdGA0YHQvtC90LDQttC10LlcbiAgYXR0YWNrQ2hhcmFjdGVyKGF0dGFja2VyLCBkZWZlbmRlcikge1xuICAgIGlmICghYXR0YWNrZXIgfHwgIWRlZmVuZGVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYXR0YWNrUG9pbnRzID0gTWF0aC5mbG9vcihNYXRoLm1heChcbiAgICAgIGF0dGFja2VyLmNoYXJhY3Rlci5hdHRhY2sgLSBkZWZlbmRlci5jaGFyYWN0ZXIuZGVmZW5jZSxcbiAgICAgIGF0dGFja2VyLmNoYXJhY3Rlci5hdHRhY2sgKiAwLjEsXG4gICAgKSk7XG5cbiAgICBpZiAoZGVmZW5kZXIuY2hhcmFjdGVyLmlzR29vZENoYXJhY3Rlcikge1xuICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyVGVhbSA9IHRoaXMuZmlsdGVyVGVhbShkZWZlbmRlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZ2FtZVN0YXRlLm9wcG9uZW50VGVhbSA9IHRoaXMuZmlsdGVyVGVhbShkZWZlbmRlcik7XG4gICAgfVxuXG4gICAgZGVmZW5kZXIuY2hhcmFjdGVyLmRhbWFnZShhdHRhY2tQb2ludHMpO1xuXG4gICAgaWYgKGRlZmVuZGVyLmNoYXJhY3Rlci5oZWFsdGggPiAwKSB7XG4gICAgICBpZiAoZGVmZW5kZXIuY2hhcmFjdGVyLmlzR29vZENoYXJhY3Rlcikge1xuICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXJUZWFtID0gWy4uLnRoaXMuZ2FtZVN0YXRlLnBsYXllclRlYW0sIGRlZmVuZGVyXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllclRlYW0gPSBbLi4udGhpcy5nYW1lU3RhdGUucGxheWVyVGVhbSwgZGVmZW5kZXJdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZ2FtZVBsYXkuc2hvd0RhbWFnZShkZWZlbmRlci5wb3NpdGlvbiwgYXR0YWNrUG9pbnRzKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLmNsaWNrT25DZWxsKCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLmVuZE1vdmUoKTtcbiAgICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY2FsY1RpbGVUeXBlIiwiaW5kZXgiLCJib2FyZFNpemUiLCJub3JtSW5kZXgiLCJyZXN1bHQiLCJOdW1iZXIiLCJpc0ludGVnZXIiLCJzbGljZSIsImRpc3RhbmNlWFkiLCJmaXJzdFBvc2l0aW9uIiwic2Vjb25kUG9zaXRpb24iLCJpbml0aWFsQ29vcmRzIiwiQXJyYXkiLCJmaWxsIiwiY29vcmRzIiwibWFwIiwiZSIsImkiLCJ4IiwieSIsIk1hdGgiLCJmbG9vciIsImN1cnJlbnRDb29yZHMiLCJuZXh0Q29vcmRzIiwiZGlmZlgiLCJhYnMiLCJkaWZmWSIsInBvc3NpYmxlTW92ZSIsImN1clBvc2l0aW9uIiwibmV4dFBvc2l0aW9uIiwibW92ZUNlbGwiLCJkaWZmQ29vcmRzIiwicG9zc2libGVBdHRhY2siLCJhdHRhY2tDZWxsIiwiQ2hhcmFjdGVyIiwiY29uc3RydWN0b3IiLCJsZXZlbCIsInR5cGUiLCJuYW1lIiwiRXJyb3IiLCJ0aGlzIiwiYXR0YWNrIiwiZGVmZW5jZSIsImhlYWx0aCIsImRhbWFnZSIsInBvaW50cyIsIlBvc2l0aW9uZWRDaGFyYWN0ZXIiLCJjaGFyYWN0ZXIiLCJwb3NpdGlvbiIsImdldEFsbG93ZWRDb29yZGluYXRlcyIsInR5cGVUZWFtIiwiYWxsQ29vcmRzIiwia2V5cyIsImFsbG93ZWRDb29yZHMiLCJmaWx0ZXIiLCJwb3MiLCJjaGFyYWN0ZXJHZW5lcmF0b3IiLCJhbGxvd2VkVHlwZXMiLCJtYXhMZXZlbCIsInJUeXBlIiwibGVuZ3RoIiwicmFuZG9tIiwickxldmVsIiwiZ2VuZXJhdGVUZWFtIiwiY2hhcmFjdGVyQ291bnQiLCJuZXdUZWFtIiwicGxheWVyQ29vcmRzIiwib3Bwb25lbnRDb29yZHMiLCJuZXdDaGFyYWN0ZXIiLCJuZXh0IiwidmFsdWUiLCJpc0dvb2RDaGFyYWN0ZXIiLCJzcGxpY2UiLCJwdXNoIiwiQm93bWFuIiwic3VwZXIiLCJEYWVtb24iLCJNYWdpY2lhbiIsIlN3b3Jkc21hbiIsIlVuZGVhZCIsIlZhbXBpcmUiLCJUZWFtIiwicGxheWVyVGVhbSIsIm9wcG9uZW50VGVhbSIsIkdhbWVTdGF0ZSIsInBsYXllck1vdmUiLCJmcm9tIiwib2JqZWN0IiwiZ2FtZVBsYXkiLCJjb250YWluZXIiLCJib2FyZEVsIiwiY2VsbHMiLCJjZWxsQ2xpY2tMaXN0ZW5lcnMiLCJjZWxsRW50ZXJMaXN0ZW5lcnMiLCJjZWxsTGVhdmVMaXN0ZW5lcnMiLCJuZXdHYW1lTGlzdGVuZXJzIiwic2F2ZUdhbWVMaXN0ZW5lcnMiLCJsb2FkR2FtZUxpc3RlbmVycyIsImJpbmRUb0RPTSIsIkhUTUxFbGVtZW50IiwiZHJhd1VpIiwidGhlbWUiLCJjaGVja0JpbmRpbmciLCJpbm5lckhUTUwiLCJuZXdHYW1lRWwiLCJxdWVyeVNlbGVjdG9yIiwic2F2ZUdhbWVFbCIsImxvYWRHYW1lRWwiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJvbk5ld0dhbWVDbGljayIsIm9uU2F2ZUdhbWVDbGljayIsIm9uTG9hZEdhbWVDbGljayIsImNsYXNzTGlzdCIsImFkZCIsImNlbGxFbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm9uQ2VsbEVudGVyIiwib25DZWxsTGVhdmUiLCJvbkNlbGxDbGljayIsImFwcGVuZENoaWxkIiwiY2hpbGRyZW4iLCJyZWRyYXdQb3NpdGlvbnMiLCJwb3NpdGlvbnMiLCJjZWxsIiwiY2hhckVsIiwiaGVhbHRoRWwiLCJoZWFsdGhJbmRpY2F0b3JFbCIsInN0eWxlIiwid2lkdGgiLCJhZGRDZWxsRW50ZXJMaXN0ZW5lciIsImNhbGxiYWNrIiwiYWRkQ2VsbExlYXZlTGlzdGVuZXIiLCJhZGRDZWxsQ2xpY2tMaXN0ZW5lciIsImFkZE5ld0dhbWVMaXN0ZW5lciIsImFkZFNhdmVHYW1lTGlzdGVuZXIiLCJhZGRMb2FkR2FtZUxpc3RlbmVyIiwicHJldmVudERlZmF1bHQiLCJpbmRleE9mIiwiY3VycmVudFRhcmdldCIsImZvckVhY2giLCJvIiwiY2FsbCIsInNob3dFcnJvciIsIm1lc3NhZ2UiLCJhbGVydCIsInNob3dNZXNzYWdlIiwic2VsZWN0Q2VsbCIsImNvbG9yIiwiZGVzZWxlY3RDZWxsIiwicmVtb3ZlIiwic3RhcnRzV2l0aCIsInNob3dDZWxsVG9vbHRpcCIsInRpdGxlIiwiaGlkZUNlbGxUb29sdGlwIiwic2hvd0RhbWFnZSIsIlByb21pc2UiLCJyZXNvbHZlIiwiZGFtYWdlRWwiLCJ0ZXh0Q29udGVudCIsInJlbW92ZUNoaWxkIiwic2V0Q3Vyc29yIiwiY3Vyc29yIiwic3RhdGVTZXJ2aWNlIiwic3RvcmFnZSIsInNhdmUiLCJzdGF0ZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwibG9hZCIsInBhcnNlIiwiZ2V0SXRlbSIsImxvY2FsU3RvcmFnZSIsImdhbWVDdHJsIiwiZ2FtZVN0YXRlIiwiaW5pdCIsInRoZW1lcyIsImVudGVyT25DZWxsIiwibGVhdmVPbkNlbGwiLCJjbGlja09uQ2VsbCIsInNlbGVjdGVkQ2hhcmFjdGVyIiwiaXNDaGFyYWN0ZXIiLCJoYXNDaGFyYWN0ZXIiLCJwZXJzb24iLCJnZXRDaGFyYWN0ZXIiLCJlbGVtZW50IiwiaXRlbSIsImN1cnNvcnMiLCJtb3ZlRGlzdGFuY2UiLCJmaWx0ZXJUZWFtIiwiZW5kTW92ZSIsImF0dGFja0Rpc3RhbmNlIiwicG9zaXRpb25DaGFyYWN0ZXIiLCJhdHRhY2tDaGFyYWN0ZXIiLCJzb21lIiwiZmluZCIsImJpbmQiLCJlbGVtIiwiYXR0YWNrZXIiLCJkZWZlbmRlciIsImF0dGFja1BvaW50cyIsIm1heCIsInRoZW4iXSwic291cmNlUm9vdCI6IiJ9